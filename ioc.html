<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at May 4, 2011 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Sody's Site - Inversion of Control</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Martin Fowler" />
    <meta name="Date-Creation-yyyymmdd" content="20050626" />
    <meta name="Date-Revision-yyyymmdd" content="20110504" />
    <meta http-equiv="Content-Language" content="en" />
        
  </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Sody's Site
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                
                <div class="xleft">
        <span id="publishDate">Last Published: 2011-05-04</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0-SNAPSHOT</span>
                      </div>
            <div class="xright">                    <a href="index.html" title="English">English</a>
            |
                        <a href="ru/index.html" title="Русский">Русский</a>
              
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                
                                <h5>Articles</h5>
                  <ul>
                  <li class="none">
                          <a href="site.html" title="Site creation using maven">Site creation using maven</a>
            </li>
                  <li class="none">
                          <a href="spi.html" title="SPI mechanism usage">SPI mechanism usage</a>
            </li>
          </ul>
                       <h5>Translates</h5>
                  <ul>
                  <li class="none">
            <strong>Inversion of Control</strong>
          </li>
                  <li class="none">
                          <a href="injection.html" title="Dependency Injection pattern">Dependency Injection pattern</a>
            </li>
                  <li class="none">
                          <a href="performance.html" title="Speeding Up Your Web Site">Speeding Up Your Web Site</a>
            </li>
          </ul>
                       <h5>Projects</h5>
                  <ul>
                  <li class="none">
                          <a href="greatage/index.html" title="Great Age">Great Age</a>
            </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Inversion of Control<a name="Inversion_of_Control"></a></h2><p>Inversion of Control is a common phenomenon that you come across when extending frameworks. Indeed it's often seen as a defining characteristic of a framework.</p><p>Let's consider a simple example. Imagine I'm writing a program to get some information from a user and I'm using a command line enquiry. I might do it something like this</p><div class="source"><pre>  #ruby
  puts 'What is your name?'
  name = gets
  process_name(name)
  puts 'What is your quest?'
  quest = gets
  process_quest(quest)
</pre></div><p>In this interaction, my code is in control: it decides when to ask questions, when to read responses, and when to process those results.</p><p>However if I were were to use a windowing system to do something like this, I would do it by configuring a window.</p><div class="source"><pre>  require 'tk'
  root = TkRoot.new()
  name_label = TkLabel.new() {text &quot;What is Your Name?&quot;}
  name_label.pack
  name = TkEntry.new(root).pack
  name.bind(&quot;FocusOut&quot;) {process_name(name)}
  quest_label = TkLabel.new() {text &quot;What is Your Quest?&quot;}
  quest_label.pack
  quest = TkEntry.new(root).pack
  quest.bind(&quot;FocusOut&quot;) {process_quest(quest)}
  Tk.mainloop()
</pre></div><p>There's a big difference now in the flow of control between these programs - in particular the control of when the <tt>process_name</tt> and <tt>process_quest</tt> methods are called. In the command line form I control when these methods are called, but in the window example I don't. Instead I hand control over to the windowing system (with the <tt>Tk.mainloop</tt> command). It then decides when to call my methods, based on the bindings I made when creating the form. The control is inverted - it calls me rather me calling the framework. This phenomenon is Inversion of Control (also known as the Hollywood Principle - &quot;Don't call us, we'll call you&quot;).</p><p><i>One important characteristic of a framework is that the methods defined by the user to tailor the framework will often be called from within the framework itself, rather than from the user's application code. The framework often plays the role of the main program in coordinating and sequencing application activity. This inversion of control gives frameworks the power to serve as extensible skeletons. The methods supplied by the user tailor the generic algorithms defined in the framework for a particular application.</i> <i>-- Ralph Johnson and Brian Foote</i></p><p>Inversion of Control is a key part of what makes a framework different to a library. A library is essentially a set of functions that you can call, these days usually organized into classes. Each call does some work and returns control to the client.</p><p>A framework embodies some abstract design, with more behavior built in. In order to use it you need to insert your behavior into various places in the framework either by subclassing or by plugging in your own classes. The framework's code then calls your code at these points.</p><p>There are various ways you can plug your code in to be called. In the ruby example above, we invoke a bind method on the text entry field that passes an event name and a <a class="externalLink" href="http://martinfowler.com/bliki/Closure.html">Closure</a> as an argument. Whenever the text entry box detects the event, it calls the code in the closure. Using closures like this is very convenient, but many languages don't support them.</p><p>Another way to do this is to have the framework define events and have the client code subscribe to these events. .NET is a good example of a platform that has language features to allow people to declare events on widgets. You can then bind a method to the event by using a delegate.</p><p>The above approaches (they are really the same) work well for single cases, but sometimes you want to combine several required method calls in a single unit of extension. In this case the framework can define an interface that a client code must implement for the relevant calls.</p><p>EJBs are a good example of this style of inversion of control. When you develop a session bean, you can implement various methods that are called by the EJB container at various lifecyle points. For example the Session Bean interface defines <tt>ejbRemove</tt>, <tt>ejbPassivate</tt> (stored to secondary storage), and <tt>ejbActivate</tt> (restored from passive state). You don't get to control when these methods are called, just what they do. The container calls us, we don't call it.</p><p>These are complicated cases of inversion of control, but you run into this effect in much simpler situations. A template method is a good example: the super-class defines the flow of control, subclasses extend this overriding methods or implementing abstract methods to do the extension. So in JUnit, the framework code calls <tt>setUp</tt> and <tt>tearDown</tt> methods for you to create and clean up your text fixture. It does the calling, your code reacts - so again control is inverted.</p><p>There is some confusion these days over the meaning of inversion of control due to the rise of IoC containers; some people confuse the general principle here with the specific styles of inversion of control (such as <a class="externalLink" href="http://martinfowler.com/articles/injection.html">dependency injection</a>) that these containers use. The name is somewhat confusing (and ironic) since IoC containers are generally regarded as a competitor to EJB, yet EJB uses inversion of control just as much (if not more).</p><p><b>Etymology</b>: As far as I can tell, the term Inversion of Control first came to light in Johnson and Foote's paper <a class="externalLink" href="http://www.laputan.org/drc/drc.html">Designing Reusable Classes</a>, published by the Journal of Object-Oriented Programming in 1988. The paper is one of those that's aged well - it's well worth a read now over fifteen years later. They think they got the term from somewhere else, but can't remember what. The term then insinuated itself into the object-oriented community and appears in the Gang of Four book. The more colorful synonym 'Hollywood Principle' seems to originate in a <a class="externalLink" href="http://www.digibarn.com/friends/curbow/star/XDEPaper.pdf">paper by Richard Sweet</a> on Mesa in 1983. In a list of design goals he writes: &quot;Don't call us, we'll call you (Hollywood's Law): A tool should arrange for Tajo to notify it when the user wishes to communicate some event to the tool, rather than adopt an 'ask the user for a command and execute it' model.&quot; John Vlissides wrote a <a class="externalLink" href="http://www.research.ibm.com/designpatterns/pubs/ph-feb96.txt">column for C++</a> report that provides a good explanation of the concept under the 'Hollywood Principle' moniker. (Thanks to Brian Foote and Ralph Johnson for helping me with the Etymology.)</p></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">Copyright &#169;                    2011
                        <a href="http://sody.github.com/">sody</a>.
            All Rights Reserved.      
                
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
